1





On the distribution of urban road space for multimodal congested networks             




                                    abstract

Transport systems in real cities are complex with  many modes of transport sharing and
competing for limited road space. This work intends to understand howspace distributions
for  modes and interactions among modes affect network trafﬁc performance. While the
connection between performance of transport systems and general land allocation is the
subject of extensive research, space allocation for interacting modes of transport is an open
research question. Quantifying the impact of road space distribution on the performance of
a congested multimodal transport  system with  a dynamic aggregated model remains a
challenge. In this paper, a multimodal macroscopic fundamental diagram (MFD) is developed to 
represent the trafﬁc dynamics of a multimodal transport system. Optimization is
performed with  the objective of minimizing  the total  passenger hours traveled (PHT) to
serve the total demand by redistributing road space among modes. Pricing strategies are
also investigated to provide a higher demand shift  to more efﬁcient modes. We ﬁnd by
an application to a bi-modal two-region city that (i) the proposed model captures the operational 
characteristics of each mode, and (ii) optimal dynamic space distribution strategies
can be developed. In practice, the approach can serve as a physical dynamic model  to
inform space distribution strategies for policy makers with different goals of mobility.
            

                                                                
Keywords:                                                                        
Space allocation 
Multi-modal
Macroscopic fundamental diagram
Optimization
Trafﬁc ﬂow
Public transport 

1. Introduction


     As cities around  the  world  grow  rapidly and more  people through   different  modes  compete  for limited   urban  road infrastructure  to  travel,
it is  important   to  understand  how  this  space can be managed  to improve   accessibility  for  travelers.  The
ultimate  goal of  research towards  this  direction  is to develop  modeling  and  optimization   tools,  which  will  contribute   on how
to redistribute   city  space to multiple   transportation   modes  and to understand  what  level  of mobility   cities  of different structures 
and  topologies  can achieve.
     Management  strategies  can be implemented   to  partition a city so that road  space is deliberately allocated  between  competing modes.  
Although  the allocation   of this space is a policy-oriented   decision,  it should  be informed   by the correct  physics
and dynamics  of the  multimodal   ﬂows.  This  system can be  treated  as an interconnected   network  of  regions (sub-networks)
with  one or moremodes   moving.  In this  extension,  different  parts  of a city can be subject  to different   management  strategies
(see for example  Fig. 1). Perhaps bus-only   streets are  allocated  only in  the  central  region  while  other  parts  of the  city allow
vehicles  to  operate  in  mixed  trafﬁc.   Changes in  infrastructure,    demand,  or  operations   in  one region   have impact   on  the
behavior  of  adjoining   regions.  While   recent  ﬁndings   in  the  macroscopic  modeling   and  dynamics  of  trafﬁc   in  cities  have




2
                                               







                                                                   Fig. 1. A multi-region, multimodal system.


provided knowledge of single-mode/single-region cities and single-mode/multi-region cities, the understanding of multi-mode, 
multi-region cities is limited.
    Under a multimodal environment, space should be allocated taking into account spatiotemporal differences in the demand, 
the topology, and the control characteristics. These spatiotemporal decisions are important because if they are made
incorrectly, space could be wasted. If this wasted space could be productively used by low-occupancy vehicles without
affecting the more productive modes, mobility is being restricted. For example, recent studies in Californian freeways, have
questioned the effectiveness of high-occupancy vehicle (HOV) lanes and have shown that HOV lanes are underutilized and
the passenger capacity of freeways has decreased, resulting in heavier congestion levels (Chen et al., 2005).
    Operational characteristics should be considered as well. Despite the different features of modes in terms of occupancy
(number of passengers), driving behavior (speeds, acceleration and deceleration proﬁles, length), duration of travel, scheduled vs. non-scheduled service, 
a common characteristic is the following: all of these vehicles whenmoving to an urban environment make stops related to trafﬁc congestion (e.g. red phases at trafﬁc signals) and other stops, which also cause delays to
the transportation system as a whole, e.g. buses stop at bus stops to board/alight passengers, taxis stop frequently and randomly 
when they search/pick up/deliver passengers, cars may stop/maneuver when search/ﬁnd a parking spot. While there
is a good understanding and vast literature of the dynamics and the modeling of congestion for congestion-related stops, the
effect of service or general purpose stops in the overall performance of a transportation system still remains a challenge. It is
intuitive that the effect of these stops during light demand conditions in the network capacity is almost negligible, but nowadays 
city centers are experiencing high level of congestion and the frequency in time and space of the service stops is signiﬁcantly high.
    In this paper, we present a macroscopic approach for optimizing road space allocation for multimodal transport systems
with focus on two modes of transport, cars and buses and two regions, the city center and the periphery. Extensions to more
complex city structures are also discussed. This approach should not only deal with the problems mentioned above, but also
will switch the interest from the currently  inefﬁcient vehicle throughput based optimization to the more efﬁcient for networks and society, 
passenger throughput optimization. Congestion pricing strategies for cars are also considered to further
facilitate the demand shift when preferential treatment to buses is offered.


2. Background

    Existing literature on the physics of urban congestion can be divided generally into city-scale, street-scale, and car-to-car
scale. City-scale investigations have thus far looked only at the behavior of one mode and the involved dynamics of trafﬁc
congestion. Studies of multiple modes, on the other hand, have only been made at the street-level scale for simplistic
time-independent scenarios. Planning studies have looked at public transport on a city scale, particularly buses on idealized
road networks. Making road space allocation decisions, however, requires consideration of interactions and dynamics between multiple modes. 
To date, such considerations have been made only at the much ﬁner street scale and still in a
time-independent and unrealistic environment. Thus, the existing body of work leaves a gap to be ﬁlled—a physically realistic time-dependent, 
city-scale model including multiple modes that interact with each other.

3


    There is a strong understanding and vast literature of congestion dynamics and spreading in street or car-to-car-scale
trafﬁc systems with a single mode of trafﬁc,  e.g. a highway section with cars. Besides trafﬁc scientists, mathematicians
and physicists have also contributed to the ﬁeld of trafﬁc ﬂow. Because of the numerous publications, we refer the reader
to (Helbing, 2001) for an overview. Brieﬂy speaking, the main modeling approaches can be classiﬁed as follows: Car-following models 
deal with the non-linear interactions and dynamics of single vehicles (e.g. Gipps, 1981). To address computational burden, 
cellular automata describe the dynamics of  vehicles in a coarse-grained way by discretizing space and
time, (e.g. Nagel and Schreckenberg, 1992; Daganzo, 1994). Gas-kinetic models formulate a partial differential equation
for the spatio-temporal evolution  of the  vehicle density and the velocity  distribution  (e.g. Helbing and Treiber, 1998).
First-order ﬂow models are based on a partial differential equation for the density and a fundamental diagram relation
(e.g. Lebacque, 1996; Leclercq et al., 2007). Second-order models contain an additional equation for non-steady state conditions. 
In continuum models, a network is approximated as a continuum in which users choose their routes in a two-dimensional space (e.g. Jiang et al., 2011).
    On the public transport side at city-scale, modelers have analyzed how systems should be designed, e.g. Wirasinghe et al.
(1977) consideredhow to systematically design a bus transit system for an idealized city with centralized demand. However,
these models have been only applied to one mode, and only in the steady-state operation. Researchers have looked at how
multiple modes can share the road, but only on the street-scale level. Sparks and May (1971) developed a mathematical
model to evaluate priority lanes for high occupancy vehicles on freeways. Later, Dahlgren (1998) and Daganzo and Cassidy
(2008) studied how different modes use freeways, recognizing that if different modes serve different numbers of passengers,
then analyses should not consider all vehicles with the same weight. But these works are limited to small scale systems. They
looked at the effect on total passenger travel time if a lane on a speciﬁc road section were dedicated to multiple occupant
vehicles. This consideration of different occupancies between vehicles is important because it recognizes that some modes
carry more passengers than others. The importance of considering passengers rather than vehicles was earlier mentioned by
Vuchic (2007). He criticized street-scale evaluations based only on vehicle ﬂows, because multimodal systems should integrate 
the occupancies of each mode. A qualitative analysis of space allocation can be found in Gonzales et al. (2010). The
quantitative treatment of the transit process (e.g. network route design, scheduling) is reﬂected in a considerable amount
of effort in numerous publications (e.g. Ceder and Wilson, 1986 and others), and will not be addressed here.
    Researchers have looked at allocating street space betweenmore than one mode, through the dedication of a freeway lane
to HOVs or a lane for buses on a city street (Radwan and Benevelli, 1983; Black et al., 1992). These methods have limited
applicability, however, because they assume steady-state trafﬁc ﬂow and they also ignore the ﬂuctuations and spill-over effects 
that typically characterize urban trafﬁc congestion. Currie et al. (2004) carried out impact analysis in planning studies
of road space allocation. That analysis was based on a disaggregate micro-simulation which relies on intensive travel data
inputs that are typically unreliable or unavailable. Researches by Pushkarev and Zupan (1977), Pickrell (1985), Kenworthy
and Laube (2001) and Cameron et al. (2005), focused on the connection between performance of transport systems and land
use for transportation as a whole, without further consideration on allocation by usage.
    More recently, Gonzales and Daganzo (2012) examined system optimum solutions for a transport system with cars and
public transit share spaces for the morning commute problem. The authors solve user and system optimum for the bottleneck model 
and system optimum for the network model (with anMFD representation). The proposed model recognizes that
the network capacity for cars is reduced if transit operations receive dedicated space. However, quantifying the impact of
this dedicated space on the performance of a transport system still remains an exclusive and challenging question. Mesbah
et al. (2011) proposed an optimization framework for optimizing transit priority and allocating dedicated bus lanes. The optimization 
aims at minimizing the total travel time of both car travelers and public users. However, travel time is estimated by
BPR function which is not valid for they dynamic case. In both references, the impact of the operation of buses (e.g. dwell
time) on the delay of travelers was not discussed.
    This gap is due to the lack of a trafﬁc model, which will represent the ﬂow dynamics of a multimodal system as a result of
road space allocation. While various theories have been proposed to macroscopically model urban networks (Godfrey, 1969;
Herman and Prigogine, 1979; Mahmassani et al., 1987; Daganzo, 2007), only until recently Geroliminis and Daganzo (2008)
demonstrated the existence of a fundamental model (the macroscopic fundamental diagram – MFD)on congestion dynamics
of single-mode system with empirical data. This reference showed that (i) an MFD is a plot between network space-mean
ﬂow and density, (ii) the MFD is a property of the network itself (infrastructure and control) and not very sensitive to demand, 
i.e. the MFD should have a well-deﬁned maximum and remain invariant when the demand changes and (iii) the
space-mean ﬂow is maximum for the same value of critical density of vehicles, for many origin–destination tables. Daganzo
and Geroliminis (2008) and Geroliminis and Boyaci (2012) have derived analytical theories for the shape of the MFD as a
function of network and intersection parameters, using variational theory (VT) for homogeneous and heterogeneous network topologies, 
respectively. Properties of well-deﬁned MFDs, stability and scatter analysis and other simulation and experimental tests 
can be found in Buisson and Ladier (2009), Ji et al. (2010), Mazloumian et al. (2010), Daganzo et al. (2011),
Geroliminis and Sun (2011), Knoop et al. (2012) and Saberi and Mahmassani (2012) and others. Recently, Gonzales et al.
(2011) observed through simulation an MFD for multimodal systems of cars and buses in the city center of Nairobi, Kenya.
    Boyaci and Geroliminis (2011) extended the VT theory for the multi-modal case and provided a semi-analytical approximation of the MFD, 
by considering that bus service related stops interact with trafﬁc as hypothetical trafﬁc signals with
periodic characteristics. The operational characteristics of this hypothetical signal-bus stop depend on the dwell times
and the frequencies of buses, while the capacity during service stops is smaller as buses might block trafﬁc. In VT theory

4
                                                     


a number of  different  observers  (forward  and backward)   move in the  system of  trafﬁc  signals and for  each observer the  average speed 
(because of  delays in  red  phases and  bus stops)  and  the maximum   passing  rate  are estimated.   These observers
create associated  ‘‘cuts’’ in  a network   ﬂow-density    diagram  and the  lower  envelope  of these  cuts provides   a good approximation 
of the  MFD for  homogeneously   congested areas. While  VT has been  proved  to provide  a  tight  cut  (see Daganzo and
Geroliminis,  2008)  in  case of corridors  with   uniform   density  (i.e.  incoming  turns  are  about equal  to  outcoming  ones).  Nevertheless, 
application  of  variational  theory  in  simulated  and real networks   (with  turns,  heterogeneous  topology,  route choice,
etc.) show  that  this  approach  is a good  approximation   if  congestion  is  evenly  distributed.
     Building  in  the knowledge   of the single-mode   macroscopic  modeling,  developing  the  dynamics  of multimodal    systems is
promising.  To  summarize,  a  macroscopic  approach  should  be  developed  to  estimate  the  dynamics  and  to  optimize   space
allocation  of  multimodal   urban  road  systems.  We will   show  that  (i)  the proposed  approach  captures  the  operational   characteristics
 of different  modes,  (ii) the  resulting  system  performances  are consistent  with   the physics  of trafﬁc  given  different
road space strategies,  e.g. with   or  without   dedicated  bus  lanes, (iii)  allocation   of  road space  can be readily   optimized   in a
static and dynamic  way,  and (iv)  pricing  strategies  can further  improve  the  efﬁciency  of the system  with  less space dedicated
for buses. Next  section  develops  the  methodological   framework   with   respect to  the  multimodal   dynamics  and  the  optimization approach.  
Section 4 presents  the results  of a case study  with  a two-region   city  and two  modes of  transport,  while  further 
research is  discussed in Section 5. Table 1 provides  a nomenclature   for the  different  variables  and parameters  utilized   in
the paper.



3. Methodological framework


     Consider a city   divided  into  N regions  as in  Fig. 1, denoted  by i  =1,...,N.    Criteria  for  partitioning   a  region  (approximate
size a few hundred   links each)  are: homogeneous  distribution    of congestion  within   each region  to obtain  a low  scatter  MFD
(see for example  Ji and Geroliminis,  2012),  similar  topological   characteristics  and similar   type of  mode usage. Any region  i is
partitioned   into  sub-regions,   each one containing   a speciﬁc  type  of  mode  usage, e.g. it  can be  dedicated  bus lanes,  mixed
trafﬁc  lanes, car-only  lanes  or any other  special  usage lanes. Demand  and their  aggregate  origin–destination    are considered
known.  We  will   later  relax  this  assumption   and investigate   how  uncertainty    and errors  in  the  demand  inﬂuence   our  approach. 
The strategy  of  allocating  fraction   of space to each sub-region   in region  i  at time  t  is denoted  by vector  pi(t)  (which
can be static e.g. 20% of space for bus-only lanes all  the time,  or dynamic  e.g. 10% during off-peak while   20% during peak). The
goal of road space optimization   for  a multi-modal   transport  system  of a city  is to minimize   the total  passenger hours traveled
(PHT) over time  for  all modes  of transport   m that  serve the  total  demand  by redistributing    the  road space in  areas with  different  
usages of the  city.  Mathematically,   the  optimization    problem  is



Table 1
List of main variables and parameters.

   Variables         Description

 Average number of passengers per car in region i
     Demand generated at time t in region i with next destination region k
    
    Demand generated at time t in region i with next destination region k, choosing mode m
      
          Bus mode share for demand 
                                                                   
           Flow exiting region i of mode m at time t as a function of accumulations
 
  Fraction of Om from region i to j with ﬁnal destination k at time t
 
 
   Total distance traveled by all vehicles of mode m in region i at time t

       Transfer ﬂow of mode m from region i to j with ﬁnal destination k

        Space share allocation of region i at time t
          Utility of using mode m at time t in region i with next destination region k
    
       Accumulation of mode m in region i with next destination region k at time t
                Accumulation of mode m currently in region i at time t
            Average number of on-board passengers per bus in region i with destination k at time t

 Binary variable showing the sequence of the trip, with value equal to 1 if a trip from region i to k passes through j immediately after
  
      leaving i, and 0 otherwise
    Total number of bus on-board passengers in region i with destination k at time t

    Parameter for the effect of dwell times on bus speed in region i at time t
   
  Average travel time and speed by using mode m in region i at time t
      
 Extra travel time spent due to bus dwell times in region i at time t
      
 Average trip length of bus passengers in region i

  Average trip length of mode m in region i
   Storage capacity of buses (persons per vehicle)
 Bus discomfort (crowdedness) in region i at time t
    
Percentage of on-board passengers reaching destination i
 Parameters for mode choice and bus crowdness

5


Eq. (1) is subject to the  dynamics  of the trafﬁc  system  of the city.  The dynamic  interactions   are illustrated  in  Fig. 2, where 
is the vector  of accumulation   of  vehicle  in different   regions,   the outﬂow,    the  demand  and   the cost of  travel  for
each of the regions. Given  the initial   state of the system  at time and a space allocation strategy,    the system  modeled  by
three parts  that  interact  at  every time   step: the  trafﬁc  state  and travel  cost of  each mode  at each region,  the ﬂow   dynamics
within   and  between  regions  and  mode  choice  of  the  generated  demand  at  each  region.  We  develop  the  methodological
framework   in the  following   sections.


3.1. Trafﬁc ﬂow  dynamics


     Let 
                 be the demand generated  in region   with  ﬁnal  destination   choosing to  travel with mode  at time. The total
             
demand generated  during  this  interval  from  . Route choice for each demand pair  from  i to k is  deﬁned
                                                                                                                                        
exogenously with   binary  variables , that show the  sequence of the trip,  with   value equal  to 1 if  a trip  from  region 
passes through immediately   after  leaving, and  otherwise.  It  is assumed that  all trips  generated  from   with   destination  
follow  the same sequence  of regions in  their  route.  For this paper  it is assumed  that  the sequence of regions  is not  altered by
trafﬁc  conditions.  Let  us now  consider  two  modes bus and  car, with   indices c and  b respectively . Let  n km ðtÞ be the
                                                                                                                                                                                              i
accumulation  of mode   in region  with  ﬁnal  destination  be the transfer ﬂow  of mode from region with  ﬁnal
                                                                                                       
Note also that  for   is  zero is the  trip  ending  ﬂow  with   ﬁnal
destination Note  that                                                      
destination  region 
     As long as ﬂow enters , it becomes part  of accumulation. The dynamic equations between  the  state variables
                                
ﬂow variables km , and the demand of the  system  with  N regions  for  the  two  modes are
                                

 is the  occupancy  of cars in  region  i, which   is a constant  (say  1–1.3 passenger  per car)  and will   remain  the  same

until  the  end  of  the  trip  and is  the  number   of generated  car  trips.  Both  equations   are discrete   versions  of a  mass
                                                      







                                                                                Fig. 2. System dynamics ﬂow chart.

6


conservation differential equation, where represents an interval. Eq. (2) States that the change of car accumulation over
                                                                                                                                                                                i
time equals to (i) the internally generated demand from region i to k minus (ii) the outﬂow from region i with ﬁnal destination k plus (iii)
the inﬂow from all regions adjacent to i with ﬁnal destination k, which is also the outﬂow for these regions.
Eq. (3) is similar to (2), but without new generation of bus trips to the system (it is assumed that the amount of buses in
service is usually constant during typical commuting hours). Note that the number of buses in each region at different times
depends on the relative speeds and MFDs of the regions.
    
                 is the minimum of two terms: the sending ﬂow from region , which depends on the accumulations of region 
              
and the boundary capacity of region, which is a function of the receiving region’s accumulations. Nevertheless, this constraint 
can be ignored during the optimization process. The physical reasoning besides this assumption is that (i) boundary
capacity decreases for accumulations much larger than the critical accumulation that maximizes ﬂow (see Geroliminis and
Daganzo (2007)), and (ii) optimized space allocation will not allow the system to get close to gridlock. Note also that

is estimated by the macroscopic fundamental diagram 
    The sending ﬂow of The MFD of modem of region i is
denoted as 
 For our approach, the given condition is that the city is partitioned in homogeneously congested
               
regions and that each region has a well-deﬁned can be analytically estimated as a function of accumulation for
                                                                                          
different mode usages and space allocations using variational theory described in the previous section. Then,

             

where is the proportion of the outgoing ﬂow from region  with ﬁnal destination. If the average distance traveled 
by travelers within region i is assumed to be independent of their destinations, then the proportion r km ðtÞ can be estimated                                                                                                                                
as a ratio of the related accumulations, according to Little’s formula (Little, 1961).

            
    We should also estimate the dynamics of passengers for each mode and every region. With respect to the car, we just
need to multiply both sides of (2) by. With respect to the bus, we need to estimate For simplicity, we assume ob i
how the occupancy of bus (in passengers) evolves over time according to demand and ﬁnished trips. The dynamics of bus
passengers are very different than bus dynamics. A simple on-board passenger mass conservation equation is

                otherwise

                 is the number of bus on-board passengers currently in region i with ﬁnal destination k. Eq. (7) estimates ob kb
In (6)                                                                                                                                                          
average number of on-board passengers per bus from region i to k. The RHS of (6) consists of the following terms: (i) the
passenger inﬂow at time for the speciﬁc OD pair, (ii) the passengers that move outside region i while in the bus, (iii)
the passengers that move inside region i while in the bus and (iv) the passengers that ﬁnish their trip inside region i. The
and zero otherwise). This term approximates the passenger trip
last term is non-zero only for (binary 
endings in region i as the mean of a Bernoulli trial which is repeated z times for each passenger with probability of success
 At each stop in region i, every on-board passenger from the previous time step has probability hi of reaching its destination. 
is the average trip length of bus passengers and si is spacing between bus stops for region i, i.e. passengers travel 
stops on average. Variable is the number of stops that a bus travels during interval, which is 
                                                                                                                                                                                                                                                                                                
the interval and is the space-mean speed of buses in region i, which will be estimated in Section 3.2). Note that the trip
                          
length of a passenger, is different than the trip length of a bus in the region. If more detailed data exists from real
measurements, the generic model can be adjusted accordingly with a non-homogeneous Bernoulli process (or a Brownian
motion). How the demand                                                      
                                              is divided between the two modes, is discussed in Section 
                                     

3.2. Multimodal travel time estimation

    The multimodal trafﬁc ﬂow dynamics of the previous section considered that the demand is known for each mode. This
will be an input of a mode choice model, which is presented in the next section. To obtain this goal, it is important to identify
the speed and travel time of each mode of transport. The estimation of space-mean speed for each mode depends on
                                                                                                                                           
the type of usage, i.e. mixed trafﬁc of cars and buses or dedicated bus lanes. Keep in mind that variational theory estimation
for shared-use of car and bus estimates the network ﬂow and of cars for given car density given the conﬂicts and the operational
characteristics   of  buses (frequency,   dwell  times,   etc.). It  does  not  estimate  the  speed  of buses  and  extra  effort  is
needed to account  for the  additional   delay due  to dwell  times.  This extra  step is not  required  in  separated bus lanes  as there
is only  one mode  of  transport.
     The space-mean speed  in a time  interval   is by  deﬁnition   the ratio  of  the total   distance traveled  and  the total   hours traveled. Let be the total  distance  traveled
  by  vehicles of  modem   (bus or  car) in  region i  at time  t  and L   the  average trip
                                                                                                                                                                          
length of  modem  in  region i. Then, for  steady state queuing  systems                                         
                                                                                                                                   
Geroliminis  and  Daganzo (2008)  have shown  that  trip  length  of cars  in downtown   Yokohama  was a time  invariant   variable.
The average trip  length  of  buses can be easily  estimated  as buses have  ﬁxed  routes.  By using the  above equations   and variational  
theory  (Daganzo  and  Geroliminis,  2008;  Boyaci  and Geroliminis,   2011),  we  can estimate  
 for  bus-only  regions. For shared-use  car–bus regions,  the speed of buses
regions and mixed  trafﬁc  car–bus  regions and  
further   decreases because  of dwell   times   for  picking   up  and  dropping   off  passengers by  a  parameter  and
If we assume that  buses  have the  same speed  with  cars  when  they  are not  stopped  at  bus stops  then
 can be approximated  as
is the total time  spent  at bus stops (total   dwell  time)  in interval   t, and TT  ðtÞ is the average travel time  of buses
                                                                                                                                               
in region  excluding, which is given  by                                                                               
 Average travel  time   of  cars in  region  ,  , can be estimated   as

     To validate  all  of the  above assumptions,  we  performed  a micro-simulation    of  San Francisco network   taken from  Geroliminis and Daganzo (2007),  
which  provides  a low scatter  MFDand  can be estimated   with  variational   theory  with  small  error.
While  in  the previous  version  this  was  a car-only  simulation,   we  performed   additional   simulations   for shared-use  bus–car
lanes and for dedicated  bus lanes with   different  bus  frequencies and  dwell  times.  Fig. 3 summarizes  the MFDs in some of  the
scenarios for  mixed  trafﬁc  (Fig. 3a)  and the  dedicated  bus lanes (Fig. 3b),  while  Fig. 3c shows  the average  speed of cars, the
speed of buses and  estimated  speed of  buses according  to  the aforementioned    methodology   (time  interval   is 5 min).  
A detailed  analysis of  these results  will   be reported   in a  future  publication   as it  is beyond  the  scope of  the current paper.

3.3. Mode choice


     Suppose that  the  selection  of the  preferred   mode is  made by  the  travelers  only  once when   they  enter the  network   and
start  their   trip.  The  total  demand   generated  at  each time   interval is assigned  to  the  preferred   modes                                                                                                                       
through  an  endogenous  approach.  Mode   choice  of a  traveler   only  happens  at  this  moment   and  remains  the  same  until
her trip  is  ﬁnished.  The choice  of a mode  is based on  the utility    of the  mode, which   is expressed as the  travel  cost  of using
that mode  at the beginning   of the trip. We consider  that  the travel  cost of  the whole  route  consists of travel  time  for  cars and
buses on-board spatial discomfort  for buses and extra costs for cars vs. buses (e.g. parking, tolls, fare) for  each region i  and interval. 
Calculation  of utility    for car and  bus for  a speciﬁc origin  destination   pair  (from  i to  k)is
                                                                                                                                                                                                       g, that
given by (10),  where  the summation   term  considers  the set of  all regions  that  a trip  passes on its route  from  
                                                            
can be estimated  using  binaries  

 




                      Fig. 3. (a) The MFD of mixed car–bus network; (b) the MFD of dedicated bus lanes; (c) speed proﬁle for mixed network.

8



     The rationale  of  the  spatial  discomfort  
is that  (i)  the  utility   of using  bus decreases if  number  of  on-board  passengers
                                                                          
(crowdedness)  increases and  (ii)  it prevents  the  buses from  reaching  overcrowded   conditions   if buses are  much faster  than
                                                                     is a function  of the  average occupancy  of a bus at time  t, which  is the  ratio  between
cars. Spatial discomfort  of  passengers 
the average on-board  passengers per  bus in region and  the storage  passenger capacity  of a bus, As the
                                                                                                                                                                                 bus
unit  of utility   is  time,  the spatial  discomfort   term  shall  be transformed   to  time  unit.  Parameter  c should  be calibrated   with
real data. Nevertheless,  during  the optimization    process, which  is described  in details  in  the next  section, we  noticed  that by
changing the  chosen value  of c by  , objective function   varies only  by . A different   formulation   with   the same logic
can be proposed  for  , which should always be a monotonically    increasing  function   of bus  average occupancy.
                                                                                                                                                             
                                                                                                                                                                               
     Given the  described utilities,   we  propose to  model the  mode choice  of buses over  time             
approach, where  the  difference  of utilities   between   the modes  for a given  origin  destination   pair  is
                                                                                                                                                                                
                                                                                                                                                                            

Eq. (12) states that  (i) if  trafﬁc  conditions  do not  change, mode choice  percentage remains  the same as of the  previous  period
and (ii)  if trafﬁc   conditions  change, mode  choice percentage  changes in  proportion   to the  difference  in utilities   as expressed
by DU k , and to the evolution  of  DU k . In such a way, we assume that  all  travelers  make  smart  choices based on  current  and
          i                                                i
historic  information.   Note that  travelers  choose themode   of travel  only once in  the beginning  of their  trip  based on the  trafﬁc
conditions  of  this time.  Parameters  b1 and b2 need to  be calibrated  with   real data.  Alternatively,   one can use the  traditional
logit-form   model.  Since we  are trying   to  model  a dynamic  choice  process and  we consider  that   a dynamic  estimation   of  a
logit  model  might  be  a challenging  task,  we utilize   the  proposed  approach.
     Eq. (12) tries  to succeed a set point,  which  is equal  utilities   of modes in  our case (equilibrium    in the  choices). This type  of
controllers  is  a generic widely   used control   loop  feedback mechanism.  The equation   calculates  an error  value  as the difference between
 a measured  process variable and a desired  setpoint. It attempts   to  minimize   the  error  DU k
                                                                                                                                                                                     by  adjusting   the
                                                                                                                                                                                   i
process inputs,  pkb i . The adjustment depends on the  present  error  (term  b1) and  the accumulation    of past  errors  (term  b2).
Sensitivity  analysis  of  parameters  c, b1 and b2 is performed   later.


3.4. Optimization  framework


     After  modeling  the  system dynamics,  we  can now  describe the  optimization framework.  Given  values for  the  space allocation  vector  p,
which  include   temporal  and  spatial  variables,  the  total  passenger hours  traveled  (PHT) can  be obtained  as
(where  T is the  duration  of  the  interval  t)
                     
     Optimization   of  (13)  is highly   non-linear.   We solve  this  problem   by a non-linear   programming    method,  the  sequential
quadratic  programming   (SQP). SQP method solves a sequence of optimization   sub-problems,  each of which   optimizes  a quadratic model  
of the  objective  subject  to a linearization   of the  constraints.  Consider a non-linear   programming   problem  of the
form subject  to constraints and . In our  case, gM(p) will  state  the constraints   of implementation  of space allocation 
in  practice,  e.g. space should not  be frequently   reallocated.   hM(p) will   be system  dynamics  equa-
tions  introduced   in  the  previous   sections.  The  general  Lagrangian  for  this   problem  is  deﬁned   as (k  and  r   are Lagrange
multipliers)
                                     

     At an  iteration   pK, an approximation   is made  of  the Hessian  of the  Lagrangian function,   using  a quasi-Newton   updating
method.  This is then  used to  generate a quadratic   programming   sub-problem,   and it  can be solved  using  any QP algorithm.
The solution  is  used to  form  a search  direction   dk for searching  a  new  iterate  pK+1 = pK + aKdK, where the step length aK is
determined  by  an appropriate   line search  procedure. The  iteration  will   continue  until   stop criterion   is achieved:  the  change
of objective  function   is below  a certain  threshold.  For detailed  description   of the  SQP algorithm,  please refer  to Nocedal  and
Wright   (2006).  We  apply  this  algorithm   for  multiple    initial   values  (around  1000)   to avoid   convergence  to  local  minima,
which  might  be  the case for  a non-smooth   objective  function.


4. Results


     An application   of the developed  methodological   framework   is performed   with  a case study of  a two-region   city. Consider
an urban network   with  two  concentric  regions, as shown  in Fig. 4. Mixed  trafﬁc  of buses and cars occurs in the  outside  region
(periphery),   while  a  fraction   of  road space  in  the  center  region  is  dedicated  to  buses.  The radius  of  the  center  region   is
R1 = 1.6 km and of the periphery   is R1 + R2 = 3.2 km. The road networks  of the  two  regions are  well  connected  at the  border.
We simulate  an  urban  road trafﬁc  system  for  4-h  (80 time  units),  a typical   morning  or  evening  period.  Demand  has a symmetric 
trapezoidal  shape with   time  and the  length  of peak period  is  equal to  1 h. A 70% fraction of  the demand  generated  in

9





                                                                             Fig. 4. An illustration of the case study.



the periphery  will   travel to  the city  center and 30% fraction  of the demand generated in the center  will  travel  to the  periphery
of the city.  The dynamics  of the system  follow  the  equations deﬁned  in  Section 3.1, 3.2 and 3.3, while  MFDs for  different  sub-areas 
are estimated  with   variational   theory.  Two modes  of transport   are considered  available  in  the  system, car  and bus. A
fraction  10% of the users are captive  and do not  have access to cars. The network   topology,  signal settings  and trafﬁc   parameters are  as follows:
   (i)  two-lane   one-way  roads  with   block  lengths  lb1 = 154m  and  lb2 = 308 m, (ii)  signal  settings   for all
intersections,  green, ; cycle,   and offset,  , (iii) a  triangular   fundamental   diagram  for each  link  with  free
ﬂow  speed  for  buses and  cars,  jam  density,   kcjam ¼ 0:15 veh=m for cars and  and congested
wave speed for  buses and  cars, .
     Static (Section  4.1) and  dynamic  (Section  4.2) space allocations   are investigated.  We  also investigate  how  an  area-based
(Section 4.3)  pricing   strategy  can further   facilitate   demand  shift  from   cars to  public  transport.   Sensitivity   analysis  for  the
non-physical   parameters  of the  model  is  performed  in  Section  4.4, while   the effect  of  demand  increase and  uncertainty   is
also integrated  in  the  analysis.


4.1. Static space allocation


     We ﬁrst   investigate  the  performance  of the  trafﬁc  system, where  a constant  amount  of space is allocated  to dedicated  bus
lanes in the  center  region  during  all  times. The  results of  the basic  scenario where  buses and  cars share the  whole  network
system without   bus lanes, and of a scenario where10%and   15% of the space in the  center region  is dedicated  to bus lanes, are
shown in  Fig. 5. Note  that  the system  performance   of the  latter  scenarios signiﬁcantly    improves.  The highly  congested  part
disappears, the  center  of the  city  operates  close to  the  maximum   outﬂow   of the  car  MFD, and total   person hours  traveled
(PHT) during  peak  hours reduces  by more  than  half.
     Since we apply  a static  space allocation  which  has only  one space variable  to  be optimized,   we can simply  enumerate   all
the possible values  of space allocation  and compare  the results.  Result of such an experiment   is shown  in Fig. 6a, where PHTs
are plotted  over percentage  of space for bus lanes. The small  ‘‘kink’’  for  is because of the behavior of captive  users that
choose bus  even  if  car  is  a faster  mode.  The  optimal   space  allocation   can be  found   around  10%. The  SQP optimization



                                                                                   (a)                                                                                                  (b)









Fig. 5. An illustration of the performance of the system with two cases of space allocation to buses: (a) the car MFD in center region (cases 10%, 15% cars
only, case 0% cars and buses mixed), (b) PHT for both modes over time.

10

approach of the previous section provides identical results. From the ﬁgure, an interesting observation is that the resulting
PHTs are similar for p = 10–15%. This means that small variations in the demand or errors in the parameters of the model will
still produce close-to-optimality results and PHTs will remain low.
    Let us check more carefully the efﬁciency of the allocated space, which is deﬁned as the ratio between the passenger trips
completed during the total simulation time and the total lane kilometers of the space for buses. Space allocations of 10% and
15% cases are compared, where efﬁciency of bus lanes is shown in Fig. 6b and efﬁciency of space of the whole center region in
Fig. 6c. If we look at the space efﬁciency of the bus lanes, it is clear that with the increase of allocated space for buses, the trip
completion rate per ln-km actually decreases. Note that for the whole region (Fig. 6c), the two cases are almost identical. The
reason is that: More space for buses allows to transport more persons on bus lanes, but at the same time it constraints the
capacity of car network and car users travel at a slower rate. Also, higher number of bus passengers increases the dwell times
and the beneﬁt of more space is smoothed off. Given the fact that the cost of operating dedicated bus lanes is high, the optimal 
solution should still hold at the lower value of 10%.


4.2. Dynamic space allocation

    It is clear in Fig. 6b that the utilization of bus lanes is higher during peak hour, while it is much less during the onset and
the offset of congestion. A dynamic space allocation strategy, where space is allocated in a time-dependent way is expected
to increase spatial efﬁciency and further minimize the total travel cost. Nevertheless, given the associated infrastructure, the
change of space should not happen many times during the day as implementation will be difﬁcult. In this section, we investigate 
the optimal solution for a four-variable, three-period dynamic space allocation strategy. The three periods are the peak
hour and the off-peak before and after the peak hour. The four optimized variables are: (1) the starting time t1 and (2) the
ending time t2 of the high space allocation, (3) space allocated to bus lane during the off-peak periods pi1 and (4) during the
peak period pi2.
    We apply the algorithm described in Section 3.4. The iteration and the solution of 10 executions with different random
initial solutions out of the 1000 are shown in Fig. 7. The dotted line in both ﬁgures indicates the best solution among these 10
examples. We see that by applying a multiple random initial search, we are indeed able to avoid local minima, for example
note a solution that gives 30% of the space to buses during the peak period.
    Fig. 8 shows the optimal solution for this dynamic space allocation strategy. The line ‘‘pi’’ is the resulting space share of
bus lanes over time, while ‘‘demand’’ is the demand proﬁle. Note that the optimal strategy allocates less space when demand






Fig. 6. (a) Total PHT and (b) efﬁciency of bus lanes given difference space allocation; (c) efﬁciency of the whole space with different space allocation of bus
lanes.

solutions by  the optimization  algorithm

             




               space share of bus lanes 



                                                           time

Fig. 7. (a) 10 Executions of the SQP optimization algorithm for different starting points and (b) the corresponding optimal solutions after a number of
iterations for each execution.

is low, but  three times  more  during  the ‘‘identiﬁed’’   peak  period. The starting  time  and  the ending  time  of the identiﬁed   peak
period makes  physical  sense, as it starts earlier  than  demand  rate reaches  its maximum   and ﬁnishes  later  than  demand rate
starts decreasing. In  such a way, the strategy  ‘‘forces’’  travelers  to choose to travel  by bus proactively,   before the  beginning  of
peak hour, therefore   all travelers  avoid  experiencing   high travel   cost. It also ‘‘tolerates’’   travelers  to choose  cars as the main
mode of  travel  after  the end  of the  peak  hours. The optimal   PHT   h, better  than  the  optimal   PHT by a static  space
allocation,  which  is  20,216 h (10% further   improvement   from   the p  = 0 solution).  Note  that  this  improvement   is  succeeded
with  15% less total  space allocated  for  buses, as expressed by  the  total  lane-km-hrs   of  individual   bus lanes.
     Now  let us compare  the  efﬁciency  of allocated  bus lanes  and the bus  occupancy during   the peak hour  between  the  static
strategy and  the dynamic  strategy.  The results are shown  in Fig. 9. During  the off-peak  period,  the dynamic strategy allocates
less space to buses, dropping  from  10% to 5%, which increases the  efﬁciency  of bus lanes (as expressed  by passengers served
per lane-kilometer    of bus  space). While  during   the  peak period,  the  dynamic   strategy  has lower  utilization rate  when  the
allocated  space increases  from  the  constant  10–16%, nevertheless  the  dynamic   strategy  actually   serves more  demand  for
buses during  the period  (shown  by  the right   ﬁgure).  Note that  two  sharp  changes for the  dynamic  case are observed  during
the space changes at times  (off-peak  to  peak, and peak to  off-peak).  Nevertheless,  the number  of served  passengers
is smooth   vs. time   (see Fig.  9b).  These changes  represent  the  transition    of  operation   between  the  two   space allocation
scenarios.
     As a high  utilization    rate  indicates  that  a large  amount  of  demand  chooses to  travel  by  bus, one  might  question   if this
strategy  will  create  cases of buses full   of passengers (at  capacity  Cbus), which is neither  comfortable   nor  realistic.  This  will
not happen  in  the  developed  model,  because (11)  ensures that  mode  choice  of buses will   reduce  signiﬁcantly   when  buses
are crowded.  If  we check  the occupancy  of  buses, as shown  in  Fig. 9b, we  see for both  the  static  strategy  and the  dynamic
strategy that  buses are  occupied less than  half  of their  capacity  (40 persons/bus).  In  fact, if  more demand  shifts  from  cars to









                                               Fig. 8. The optimal solution of a time-dependent bus lane space allocation strategy.

12
                                            







                   Fig. 9. Comparison of static and dynamic allocation: (a) space efﬁciency vs. time and (b) average bus occupancy vs. time.


buses, while buses are given enough space to travel with high speed, PHT could be further reduced. This is investigated in the
next section.


4.3. Dynamic space allocation with congestion pricing

    Following the discussion,we will investigate measures to improve the occupancy of buses. To triggermode shift from cars
to buses, we apply an area-based pricing in the peak-hour, where car users have to pay when they drive in the center of the
city. The cost of pricing is added into (10) and inﬂuences the mode choice. Since toll is in money units, we transform it to
time by multiplying with a value-of-time (VOT). In our applicationwe utilize a value of 16 Swiss Franc (CHF) per hour, which
is estimated based on an analysis by Axhausen et al. (2007) for Swiss travelers. The start and end of pricing is assumed to be
the same as of the peak-hour space allocation, between t1 and t2. The amount of toll charged c1 is an additional variable to be
optimized (5 in total). In our analysis we assume that toll will only affect the mode choice and not the departure time of the
trip. While an analysis of the morning commute for multiple modes is analyzed for a simpler system in Gonzales and Daganzo (2012), 
departure time is not  included in  this current  work as it  will make the modeling part very tedious and intractable.
    We execute this ﬁve-variable optimization with the SQP algorithm with  multiple  initial  searches. The total PHT is
18,215 h, which is about 12% smaller than thePHT without pricing and dynamic space allocation. The space allocation during
the peak period decreases from p = 16% without pricing to 14%, while values for t1 and t2 are identical for the two cases. The
savings in PHT are about the same with the total toll paid divided by VOT. While this is the case in the single bottleneck
model (Vickrey, 1969), in systems governed by a variable capacity (like the MFD model of this paper), savings can be much
larger, because congested states are avoided (Geroliminis and Levinson, 2009). But, the no toll case operates close to capacity,
because of an efﬁcient space allocation, while the toll paid is similar to delay savings. Nevertheless, as we will show later, an
increase in the demand of travel in a city can create additional congestion and given that a new design of space allocation is
not an easy solution (due to high infrastructure cost), variations in pricing can signiﬁcantly improve the state of the system
and avoid congestion.
    The occupancy of buses over time is compared in Fig. 10a where ‘‘dynamic with pricing’’ is the resulting bus occupancy of
the pricing strategy. As expected, the buses are more occupied after pricing. Besides, it can be observed that the occupancy
goes to zero earlier when approaching the end of the simulation (interval 81), indicating that passengers are able to ﬁnish
their trips earlier. This shows that a faster travel speed is achieved for all users and it corresponds to a reduction in PHT.
Fig. 9b shows the MFD states for cars in the center of the city. The two different maximum values for the dynamic case represents 
the two different space allocations. With pricing the system operates at a more reliable state as this is less than the
critical accumulation that maximizes outﬂow. As we will show later, in this case the system can absorb in-
crease in demand or small stochastic ﬂuctuations without entering the congested regime, while in the case without pricing,
a demand increase will also be associated with higher congestion.
    The pricing strategy also succeeds higher demand shift and utilization rates of the buses during peak hours (Fig. 9c and d)
shows how the utility of bus and car change over time for two different O–D pairs (center to center and periphery to center).
Note that when bus share is minimum, car utility (during the off-peak) is signiﬁcantly higher, while during the other times
the two utilities are about the same. Thus, (12) succeeds in identifying a dynamic equilibrium of mode choice.


4.4. Sensitivity analysis

    In this section we discuss how sensitive is the resulting PHT, if parameters of mode choice b1 and b2 in (12) and discom-
fort parameter c in (11) are given different values. We also investigate how an increase in the demand will create additional
congestion and if this can be resolved without a new re-distribution  of the urban space. Table 2 shows the results of a

13



                                                                   (a)                                                                                                 (b)
















                                                                                     (c)                                                                                      (d)














Fig. 10. Comparison of the dynamic allocation with and without pricing: (a) occupancy of buses vs. time; (b) MFDs of the center region for cars; (c) mode
share of bus vs. time and (d) utilities of car and bus vs. time for trips from center to center (C–C) and periphery to center (P–C) for the ‘‘dynamic with
pricing’’ case.



sensitivity   test. The basic scenario  is the  one where  the  solution   of Section 4.2  is applied.  For each of  the three  parameters,
values vary  by  percentages as shown  in  the  ﬁrst  row  of  the table.  When  one parameter   is changing,  the  other  two  remain
constant  and the  corresponding   change of PHT is  calculated.
     We see that  the changes of and have small  impact  on the  resulting  PHT, while  the  change of c has relatively   greater
impact. This  result shows a good property  of  b1 and b2. For c the result is consistent  with   reality.  A higher  value of c prevents
users from  using buses therefore  worse  off the  whole  system signiﬁcantly,   while   a low c encourages  users and consequently
reduces PHT. But when  c is too low,  buses attract  too  much demand,  the dwell   times increase  and reduce the  speed of buses
therefore  PHT starts  to increase  again.
     Note that  for  b1 and b2, an extreme   high  value will   result  to  an ‘‘all-or-nothing’’    mode  choice:  all  users choose to  travel
with  the better  mode  but then  the  travel  cost of this  mode becomes huge  suddenly  and result  a complete  choice of the  other
mode in  the next  time  period,  creating  unrealistic   instability   and oscillations.   For c, a high  value will   prevent  travelers  from
choosing buses, which  not  only  underutilizes   the  bus space but  also results  in heavier  congestion  for  cars. In our  model,  we
tune  the parameters   via trial-and-error,    with   the  objective  of  having  a coherent  and  stable  mode choice  process. As  mentioned  already,  
these parameters  need  to be  calibrated  when  the  model  is applied  in  a real  city.
     During  the optimization   process, perfect  information   about  thedemand   proﬁlewas   assumed. In reality   demand can experience stochastic 
ﬂuctuations   or erroneous  measurements,  as it  might  not be straightforward    to  accurately  measure, even at
the aggregate level.  To investigate  how  the model  reacts under  demand  uncertainty,   the effect  of unbiased  and biased errors
are introduced  for  the optimal   solution,  obtained  by the  trapezoidal  demand.  With  respect  to the unbiased  demand,we   consider ﬂuctuations
 from  the  deterministic   trapezoidal   demand  as a standard normal   distribution   Nð0;1Þ, multiplied    by a degree of error 
 We perform  multiple   runs for  values of  and the predetermined
                                  
space allocation  and tolls.  Even for large  degrees of error,  the total   passenger hours traveled  (PHT) do  not change  more than
5%, which highlights   that  the  approach  is robust  and  not  very  sensitive  to random   demand  ﬂuctuations.



Table 2
Sensitivity analysis on b1b2 and c.

                                    Change of parameters  
   
14

    In the case of biased error, for example because of a demand increase, the analysis is more complicated as PHT can signiﬁcantly increase. 
The reason is that the base case represents a high demand case, which without efﬁcient space allocation
creates signiﬁcant congestion, while the optimized solution operates at the network capacity in the center region for the
roads devoted to cars. Thus, this demand increase will create states in the congested part of the MFD and increase the
PHT. Nevertheless, a new redistribution of the urban space might not be a feasible solution due to high infrastructure costs
and it should not be performed frequently. Instead, a change in the price of toll is easy to be implementedand for some range
of demand increase can still lead the system to an efﬁcient state and avoid states in the congested part of the MFD, which
results in network capacity loss. To quantitatively analyze the above, we estimate the total PHT of the two-region model as
demand increases for the optimal space allocation and tolls of the base scenario. Afterwards, we keep the space allocation
identical and optimize the system with respect to the value of the toll in the peak hour for different demand levels.
    The results are summarized in Fig. 11, wherePHT for different demandincrease is estimated for (i) the dynamic allocation
without toll, (ii) the dynamic allocation with ﬁxed toll of the base scenario and (iii) the dynamic allocation with toll re-optimization 
for each demand level. We also show the average bus occupancy (in passengers/bus) during the peak hour for the
three scenarios and the price of the optimal toll. Note that with price re-optimization, bus utilization is much higher while
congested states are avoided for demand increase up to 25% (see the associated MFDs for cars in the city center). For higher
increase (>25%) buses become full and congestion is unavoidable. The price of toll stabilizes for higher demand as buses are
full and cannot attract more passengers. A solution in this case is to introduce more frequent buses in the system, which will
allow for lower bus occupancy, but it might decrease the efﬁciency of the bus network.


5. Discussion

    In this paper, we present a macroscopic approach for allocating road space among modes of transport with the objective
of minimizing the total travel time of travelers. Weextend the single-modeMFD to multimodal cases, and utilize it to reproduce 
the trafﬁc dynamics of a multimodal multi-region urban transport system. The extended model also considers the effect
of scheduled stops on the operation of public transport, as it quantiﬁes their effect on the average speed of the mode. This
trafﬁc model is consistent with the physics of trafﬁc and the operational characteristics of a multimodal system. It can be
analytically estimated and it can be practically observed with fewer requirements or data. Furthermore, we propose a dynamic 
mode choice model in order to investigate how the change of road space inﬂuences mode choice behavior and trafﬁc
performance. Given relevant information of a city (its road space allocation strategy and an aggregated O–D proﬁle), the performance 
of the city can be evaluated and optimal space strategy can be provided with our approach.
    Weapply the approach on a two-region bi-modal city case study, and investigate the performance of two space allocation
strategies for the center region of the city, where demand is high and heavy congestion exists for static and dynamic case.












                     Fig. 11. Comparison of system performances under different pricing scenarios for different levels of demand increase.

15
                                          


Comparing    the   two   optimal    solutions,     we  ﬁnd   that   the   dynamic    allocation     strategy    manages    to  minimize     the   PHT  in  amore
efﬁcient    way    as it   utilizes    the   bus   lane  space   better    during    the   off-peak     period   and   serves   a  higher    amount    of   passengers
during    peak   period.    In   practice    policy     makers    may   need   to   make   trade-off     between     the   operation      cost   of  bus   lanes   and
the  savings   in   PHT,  as it   is not   always    efﬁcient     to  give   space  to  bus   lanes.  By  implementing        pricing    during    the   peak  period,
more   demand   shifts    from   cars  to  buses,   which    increases   the   occupancy    of  buses  and   further    reduces   the   PHT.  The  result   of  a
sensitivity     analysis    shows    the  robustness     of  our   approach    towards     the  ﬂuctuations       in  the   inputs    and  model    parameters.
      The  results    of  the  proposed     approach    are  promising.      Ongoing    work    focuses   on  testing    the   space  allocation      strategies    in
microscopic     trafﬁc    models    and  investigates     if   the  ﬁndings     by  macroscopic     models    are  consistent     with   the   outputs    by   traditional
microscopic      models.   Further    research   direction     is  to  investigate     (i)  deeper   analysis    of  multiple     regions,   where    regional
route   choice    might    change,    (ii)   incorporate      parking     space  in   the   developed     framework      and   consider    the   effect    of  limited
parking    space   into    account    for   mode    choice,    (iii)    combine     space   allocation     with    perimeter      control     of   trafﬁc    signals    and
bus  priority     and  (iv)   integrate     additional     modes   like   taxis,   tram    and  metro    lines.   Another    future    direction     is  how   the  output
of  this   macroscopic     optimization       framework      can  be  implemented       in   reality    (i.e.  how    to  choose   which    roads   should    be  de-
voted   to  public    transport).     The  multimodal       urban   modeling     should    be  also  investigated      by  considering     additional     heterogeneity
(i)   among   users,   with    respect    to  their    mode   choices   and   the  trip    length    and  (ii)   among    different     regions    of  a  city.



